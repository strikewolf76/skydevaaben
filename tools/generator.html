<!doctype html>
<html lang="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Skydevaaben Redirect Generator</title>
  <style>
    :root { color-scheme: light dark; }
    body { font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; max-width: 1120px; margin: 24px auto; padding: 0 16px; }
    h1 { font-size: 22px; margin: 0 0 8px; }
    .muted { opacity: .8; font-size: 13px; margin: 0 0 14px; }
    .panel { border: 1px solid rgba(127,127,127,0.25); border-radius: 14px; padding: 14px; margin-top: 14px; }
    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px 16px; }
    .full { grid-column: 1 / -1; }
    label { display: block; font-size: 12px; opacity: 0.85; margin-bottom: 6px; }
    input, textarea { width: 100%; box-sizing: border-box; padding: 10px 12px; border-radius: 10px; border: 1px solid rgba(127,127,127,0.35); background: transparent; }
    textarea { min-height: 100px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    .row { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; margin-top: 12px; }
    button { padding: 10px 14px; border-radius: 10px; border: 1px solid rgba(127,127,127,0.35); background: rgba(127,127,127,0.12); cursor: pointer; }
    button.primary { background: rgba(0, 120, 255, 0.18); }
    button.danger { background: rgba(255, 0, 0, 0.10); }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size: 12px; }
    .hint { font-size: 12px; opacity: 0.8; margin-top: 6px; }
    .ok { color: #0a7; }
    .bad { color: #c33; }
    .chip { border:1px solid rgba(127,127,127,0.25); border-radius:999px; padding:8px 10px; display:flex; gap:8px; align-items:center; }
    .chip input { width:auto; }
    .small { font-size: 12px; opacity:.9; }
    .ogpreview { display:grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    @media (max-width: 920px) { .grid, .ogpreview { grid-template-columns: 1fr; } }

    .log { display:flex; flex-direction:column; gap:10px; }
    .logitem { border:1px solid rgba(127,127,127,0.22); border-radius:14px; padding:12px; }
    .logitem .top { display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between; }
    .logitem .path { font-weight:600; }
    .logitem a { word-break: break-all; }
  </style>
</head>
<body>
  <h1>Skydevaaben – Redirect Generator</h1>
  <p class="muted">
    Mål: HTML → <span class="mono">tracks/&lt;slug&gt;/&lt;dest&gt;/&lt;utm_content&gt;.html</span> og bilde → <span class="mono">assets/og/&lt;slug&gt;.jpg</span>.
  </p>

  <div class="panel">
    <div class="grid">
      <div>
        <label for="repoBase">Pages base URL</label>
        <input id="repoBase" value="https://strikewolf76.github.io/skydevaaben" />
        <div class="hint">Brukes til absolutte <span class="mono">og:url</span>/<span class="mono">og:image</span>.</div>
      </div>

      <div>
        <label for="siteName">og:site_name</label>
        <input id="siteName" value="Skydevaaben" />
      </div>

      <div class="full">
        <label for="title">Title</label>
        <input id="title" value="Born Again (Crimson Noise Remix)" />
      </div>

      <div class="full">
        <label for="ghToken">Publish token (fine-grained PAT)</label>
        <input id="ghToken" type="password" placeholder="Paste PAT (Contents: Read+Write)" />
        <div class="hint">Brukes kun i nettleseren for å publisere; ikke lagres i repo. Lagres lokalt i nettleseren for gjenbruk.</div>
        <div class="row" style="margin-top:8px;">
          <button id="btnForgetToken">Forget saved token</button>
          <div class="hint">Hvis token mangler/feiler, vi ber deg lage nytt og lagrer det lokalt.</div>
        </div>
      </div>

      <div>
        <label for="trackSlug">Track slug</label>
        <input id="trackSlug" value="born-again-crimson-noise" />
      </div>

      <div>
        <label for="utmCampaign">utm_campaign</label>
        <input id="utmCampaign" value="born-again-crimson-noise" />
      </div>

      <div class="full panel">
        <div><strong>Destinations</strong></div>
        <div class="hint">Spotify bygges fra URL (ID hentes automatisk). Andre trenger full URL.</div>

        <div class="row" style="margin-top:6px;">
          <button id="btnDestSpotifyOnly">Preset: Spotify only</button>
          <button id="btnDestAll">Preset: All destinations</button>
        </div>

        <div class="grid" style="margin-top:10px;">
          <div class="chip">
            <input id="destSpotify" type="checkbox" checked>
            <div>
              <div><strong>Spotify</strong> <span class="small">(parse from URL)</span></div>
              <div class="hint mono">tracks/&lt;slug&gt;/spotify/…</div>
            </div>
          </div>
          <div>
            <label for="spotifyUrl">Spotify track URL</label>
            <input id="spotifyUrl" placeholder="https://open.spotify.com/track/..." />
          </div>

          <div class="chip">
            <input id="destApple" type="checkbox">
            <div>
              <div><strong>Apple</strong> <span class="small">(requires URL)</span></div>
              <div class="hint mono">tracks/&lt;slug&gt;/apple/…</div>
            </div>
          </div>
          <div>
            <label for="appleUrl">Apple URL</label>
            <input id="appleUrl" placeholder="https://music.apple.com/..." />
          </div>

          <div class="chip">
            <input id="destDeezer" type="checkbox">
            <div>
              <div><strong>Deezer</strong> <span class="small">(requires URL)</span></div>
              <div class="hint mono">tracks/&lt;slug&gt;/deezer/…</div>
            </div>
          </div>
          <div>
            <label for="deezerUrl">Deezer URL</label>
            <input id="deezerUrl" placeholder="https://www.deezer.com/..." />
          </div>
        </div>
      </div>

      <div class="full panel">
        <div><strong>Channels</strong></div>
        <div class="hint">Filer navngis <span class="mono">&lt;utm_content&gt;.html</span> per destination.</div>

        <div class="row" style="margin-top:6px;">
          <button id="btnChAdsAll">Preset: Ads (Meta+TikTok+YouTube)</button>
          <button id="btnChSocialLight">Preset: Social light (Meta+IG DM)</button>
          <button id="btnChMinimal">Preset: Minimal (Meta only)</button>
        </div>

        <div class="grid" style="margin-top:10px;">
          <div class="chip">
            <input id="chMeta" type="checkbox" checked>
            <div>
              <div><strong>Meta Ads</strong> <span class="small mono">meta / paid_social</span></div>
            </div>
          </div>
          <div>
            <label for="metaContent">utm_content (Meta)</label>
            <input id="metaContent" value="meta-ads-story01" />
          </div>

          <div class="chip">
            <input id="chTikTok" type="checkbox" checked>
            <div>
              <div><strong>TikTok Ads</strong> <span class="small mono">tiktok / paid_social</span></div>
            </div>
          </div>
          <div>
            <label for="ttContent">utm_content (TikTok)</label>
            <input id="ttContent" value="tt-ads-infeed01" />
          </div>

          <div class="chip">
            <input id="chYouTube" type="checkbox" checked>
            <div>
              <div><strong>YouTube Ads</strong> <span class="small mono">youtube / paid_video</span></div>
            </div>
          </div>
          <div>
            <label for="ytContent">utm_content (YouTube)</label>
            <input id="ytContent" value="yt-ads-instream01" />
          </div>

          <div class="chip">
            <input id="chIGDM" type="checkbox">
            <div>
              <div><strong>IG DM</strong> <span class="small mono">instagram / dm</span></div>
            </div>
          </div>
          <div>
            <label for="igdmContent">utm_content (IG DM)</label>
            <input id="igdmContent" value="ig-dm-v1" />
          </div>
        </div>
      </div>

      <div class="full panel">
        <div class="ogpreview">
          <div>
            <div><strong>OG image upload</strong></div>
            <div class="hint">På publish opprettes <span class="mono">assets/og/&lt;slug&gt;.jpg</span> automatisk.</div>
            <div style="margin-top:10px;">
              <input id="ogFile" type="file" accept="image/*" />
            </div>
            <div class="hint mono" id="ogFileInfo"></div>
            <div class="hint">Målfil: <span class="mono" id="ogImageNamePreview"></span></div>
            <div class="hint">Drag & drop et bilde på previewen for rask opplasting.</div>
          </div>

          <div>
            <div><strong>Preview (cropped to 1200×630)</strong></div>
            <canvas id="ogCanvas" width="1200" height="630" style="width:100%;height:auto;border-radius:12px;border:1px solid rgba(127,127,127,0.2);"></canvas>
          </div>
        </div>
      </div>

      <div class="full panel">
        <div><strong>Validation</strong></div>
        <div id="validation" class="mono"></div>
      </div>
    </div>

    <div class="row">
      <button class="primary" id="btnGenerate">Generate batch (preview log)</button>
      <button class="primary" id="btnCheckToken">Check token</button>
      <button class="primary" id="btnPublish">Publish to GitHub (create/update files)</button>
      <button class="danger" id="btnReset">Create new / refresh</button>
      <button id="btnCopyUrls">Copy all Pages URLs</button>
      <button id="btnQrBatch">Generate QR PNGs (batch)</button>
    </div>
  </div>

  <div class="panel">
    <div><strong>Log</strong></div>
    <div class="hint">Her ser du hvilke repo-paths og Pages-lenker som genereres/publiseres.</div>
    <div id="log" class="log" style="margin-top:10px;"></div>
  </div>

  <script src="./generator.js"></script>
</body>
</html>
